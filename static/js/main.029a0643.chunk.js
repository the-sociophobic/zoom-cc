(this["webpackJsonpzoom-cc"]=this["webpackJsonpzoom-cc"]||[]).push([[0],{22:function(t,e,n){},49:function(t,e,n){"use strict";n.r(e);var r=n(0),o=n(2),s=n.n(o),a=n(12),c=n.n(a),i=n(5),u=n(7),l=n(6),d=(n(28),n(11)),b=n(9),p=n(1),m=n.n(p),j=n(4),f=n(8),h=n.n(f),x=n(51),O=n(10),v=n.n(O),g={id:{type:"ref"},APIToken:{type:"string",required:!0,example:"zjhdfboepsDKFB"},line:{type:"string",required:!0,example:"\u043f\u0440\u0438\u0432\u0435\u0442,"},number:{type:"number",required:!0,example:0},posted:{type:"number",example:123e4}},k=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(t){var o;return Object(i.a)(this,n),(o=e.call(this,t)).focus=function(){return o.inputFieldRef.current&&o.inputFieldRef.current.focus()},o.blur=function(){return o.inputFieldRef.current&&o.inputFieldRef.current.blur()},o.onKeyDown=function(t){var e=""+o.props.value;o.props.number&&o.props.value&&e.match(/[^0-9]/g)&&o.props.onChange(e.replace(/[^0-9]/g,"")),o.props.onKeyDown&&o.props.onKeyDown(t)},o.onFocus=function(t){o.props.onFocus&&o.props.onFocus(t)},o.onBlur=function(t){o.props.onBlur&&o.props.onBlur(t)},o.render=function(){return Object(r.jsxs)("div",{className:"form-group "+o.props.className+" "+(o.props.errorMessage&&"form-group--error"),children:[Object(r.jsx)("input",{ref:o.inputFieldRef,type:o.props.number?"number":"text",className:"form-group__input",placeholder:o.props.placeholder,required:o.props.required,value:o.props.value,onChange:function(t){return o.props.onChange(t.target.value)},onFocus:o.onFocus,onBlur:o.onBlur,onKeyDown:o.onKeyDown,disabled:o.props.disabled}),o.props.label&&Object(r.jsx)("label",{className:"form-group__label",children:o.props.label})]})},o.inputFieldRef=t.inputFieldRef||s.a.createRef(),o}return n}(o.Component),_="https://schedule.tochkadostupa.spb.ru/zoom-cc/",w=function(t){var e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)};n(22);h.a.defaults.headers.post.Accept="*/*",h.a.defaults.headers.post["Content-Type"]="json";var N=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(t){var o;Object(i.a)(this,n),(o=e.call(this,t)).componentDidMount=function(){return o.login(o.state.APIToken)},o.activateLoader=function(){var t=Object(j.a)(m.a.mark((function t(e){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o.setState({loading:!0}),t.next=3,e();case 3:o.state.subtitles.forEach((function(t){return t.ref.current&&(t.ref.current.style="")})),o.setState({loading:!1});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),o.tryPost=function(){var t=Object(j.a)(m.a.mark((function t(e,n){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.activateLoader(Object(j.a)(m.a.mark((function t(){var r;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.a.post(e,n);case 2:if(!(r=t.sent.data).error){t.next=7;break}return console.log(r.error),alert("Error: check the console"),t.abrupt("return");case 7:o.setState({subtitles:[].concat(Object(b.a)(r),[{APIToken:o.state.APIToken,number:0===r.length?1:r[r.length-1].number+1,line:""}]).map((function(t){return Object(d.a)(Object(d.a)({},t),{},{ref:s.a.createRef()})}))});case 8:case"end":return t.stop()}}),t)}))));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),o.login=function(){var t=Object(j.a)(m.a.mark((function t(e){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=5;break}return t.next=3,o.tryPost(_+"login",{APIToken:e});case 3:o.setState({APIToken:e}),window.localStorage.setItem("APIToken",e);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),o.logout=function(){window.localStorage.removeItem("APIToken"),o.setState({APIToken:void 0,subtitles:[],APITokenInput:"",initialText:""})},o.next=Object(j.a)(m.a.mark((function t(){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.tryPost(_+"next",{APIToken:o.state.APIToken});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),o.saveSubtitle=function(){var t=Object(j.a)(m.a.mark((function t(e){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.tryPost(_+"save",{subtitle:v.a.pick(e,v.a.keys(g))});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),o.deleteSubtitle=function(){var t=Object(j.a)(m.a.mark((function t(e){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.tryPost(_+"delete",{subtitle:v.a.pick(e,v.a.keys(g))});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),o.swapSubtitles=function(){var t=Object(j.a)(m.a.mark((function t(e,n){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.tryPost(_+"swap",{subtitle0:e.id,subtitle1:n.id});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),o.insertSubtitle=function(t,e){o.setState({subtitles:[].concat(Object(b.a)(o.state.subtitles.slice(0,e+1)),[{line:"",number:t.number+1,APIToken:o.state.APIToken,ref:s.a.createRef()}],Object(b.a)(o.state.subtitles.slice(e+1)))}),setTimeout((function(){return o.state.subtitles[e+1].ref.current.focus()}),200)},o.renderLoading=function(){return o.state.loading&&Object(r.jsx)("div",{className:"loader"})},o.renderLogin=function(){return Object(r.jsx)("div",{className:"login",children:Object(r.jsxs)("div",{className:"container",children:[Object(r.jsx)(k,{value:o.state.APITokenInput,onChange:function(t){return o.setState({APITokenInput:t})},label:"ZOOM API token",placeholder:"Copy the API token from Zoom. Paste it here"}),Object(r.jsx)("button",{className:"button button--main mt-3",onClick:function(){return o.login(o.state.APITokenInput)},children:"Log in"})]})})},o.renderControl=function(){return Object(r.jsxs)("div",{className:"control",children:[Object(r.jsx)("div",{className:"container",children:Object(r.jsxs)("div",{className:"control__header",children:[Object(r.jsx)("div",{className:"control__header__token",children:o.state.APIToken.slice(o.state.APIToken.indexOf("id"))}),Object(r.jsx)("button",{className:"control__header__exit",onClick:function(){return o.logout()},children:"Log out"})]})}),Object(r.jsx)("div",{className:"control__content",children:o.renderSubtitles()}),Object(r.jsx)("div",{className:"control__next",children:Object(r.jsx)("div",{className:"container",children:Object(r.jsx)("button",{disabled:0===o.state.subtitles.filter((function(t){return!t.posted})).length||!o.state.subtitles.filter((function(t){return!t.posted}))[0].id,className:"button button--main",onClick:function(){return o.next()},children:"NEXT"})})})]})},o.renderSubtitles=function(){return Object(r.jsx)("div",{className:"container",children:Object(r.jsx)("div",{className:"control__subtitles",children:0!==o.state.subtitles.length&&o.state.subtitles[0].id?o.state.subtitles.map((function(t,e){return Object(r.jsxs)("div",{className:"control__subtitles__item ".concat(t.posted&&"control__subtitles__item--posted"),children:[Object(r.jsx)("div",{className:"control__subtitles__item__number",children:t.id&&"".concat(t.number,".")}),t.posted?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("div",{className:"control__subtitles__item__input",children:t.line}),Object(r.jsx)("button",{className:"button button--control button--copy",onClick:function(){return w(t.line)},"data-toggle":"tooltip","data-placement":"bottom",title:"copy this subtitles text to clipboard"}),Object(r.jsx)("div",{className:"control__subtitles__item__posted",children:Object(x.a)(new Date(t.posted),"HH:mm:ss")})]}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("textarea",{ref:t.ref,className:"control__subtitles__item__input",value:t.line,rows:1,onKeyDown:function(e){return 27===e.keyCode&&t.ref.current&&t.ref.current.blur()},onChange:function(n){o.setState({subtitles:[].concat(Object(b.a)(o.state.subtitles.slice(0,e)),[Object(d.a)(Object(d.a)({},t),{},{line:n.target.value})],Object(b.a)(o.state.subtitles.slice(e+1)))}),n.target.value.includes("\n")&&(t.ref.current.style.height="200px")},onBlur:function(){return o.saveSubtitle(t)}}),Object(r.jsxs)("div",{className:"control__subtitles__item__buttons",children:[Object(r.jsx)("button",{className:"button button--control button--add",disabled:!t.id||e>o.state.subtitles.length-3,onClick:function(){return o.insertSubtitle(t,e)},"data-toggle":"tooltip","data-placement":"bottom",title:"add new subtitle after that one"}),Object(r.jsx)("button",{className:"button button--control button--remove",disabled:!t.id,onClick:function(){return o.deleteSubtitle(t)},"data-toggle":"tooltip","data-placement":"bottom",title:"remove this subtitle"}),Object(r.jsx)("button",{className:"button button--control button--down",disabled:!t.id||e===o.state.subtitles.length-2,onClick:function(){return o.swapSubtitles(t,o.state.subtitles[e+1])},"data-toggle":"tooltip","data-placement":"bottom",title:"move this subtitle down"}),Object(r.jsx)("button",{className:"button button--control button--up",disabled:!t.id||0===e||0!==o.state.subtitles[e-1].posted,onClick:function(){return o.swapSubtitles(t,o.state.subtitles[e-1])},"data-toggle":"tooltip","data-placement":"bottom",title:"move this subtitle up"})]})]})]},t.id||t.number)})):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("textarea",{className:"control__subtitles__textarea",value:o.state.initialText,onChange:function(t){return o.setState({initialText:t.target.value})},placeholder:"Enter text and press \xabsave\xbb. Each line will be a separate subtitle"}),Object(r.jsx)("button",{className:"button button--main",disabled:0===o.state.initialText.length,onClick:function(){return o.saveSubtitle({line:o.state.initialText,APIToken:o.state.APIToken,number:1})},children:"save"})]})})})},o.render=function(){return Object(r.jsxs)("div",{className:"NewVersion",children:[o.state.APIToken?o.renderControl():o.renderLogin(),c.a.createPortal(o.renderLoading(),document.body)]})};var a=window.localStorage.getItem("APIToken");return o.state={APITokenInput:"",APIToken:a||"",subtitles:[],initialText:"",loading:!1},o}return n}(s.a.Component);h.a.defaults.headers.post.Accept="*/*",h.a.defaults.headers.post["Content-Type"]="json";var I=function(t){return t.APIToken+"&seq=".concat(t.count,"&lang=ru")},T=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(t){var o;return Object(i.a)(this,n),(o=e.call(this,t)).next=function(){var t=o.state,e=t.current,n=t.counter,r=t.text,s=t.APIToken;e>=r.split("\n").length||(window.history.replaceState(null,null,"/zoom-cc/#"+n),console.log(n),function(t){h.a.post(_+"old",{URL:I(t),string:t.string+"\n"}).then((function(t){return console.log(t.data)}))}({string:r.split("\n")[e],count:n,APIToken:s}),o.setState({current:e+1,counter:n+1}))},o.render=function(){return Object(r.jsxs)("div",{className:"OldVersion",children:[Object(r.jsx)("div",{className:"container",children:Object(r.jsx)(k,{value:o.state.APIToken,onChange:function(t){return o.setState({APIToken:t})},label:"ZOOM API token",placeholder:"\u0421\u043a\u043e\u043f\u0438\u0440\u0443\u0439\u0442\u0435 \u0438 \u0432\u0441\u0442\u0430\u0432\u044c\u0442\u0435 ZOOM API token \u0438\u0437 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f"})}),Object(r.jsxs)("div",{className:"container",children:["\u0422\u0435\u043a\u0443\u0449\u0438\u0439 \u0441\u0443\u0431\u0442\u0438\u0442\u0440: ",0===o.state.current?"":o.state.current<=o.state.text.split("\n").length&&o.state.text.split("\n")[o.state.current-1]]}),Object(r.jsx)("div",{className:"container",children:Object(r.jsx)("textarea",{className:"LinedTextArea",value:o.state.text,onChange:function(t){return o.setState({text:t.target.value})}})}),Object(r.jsx)("div",{className:"container",children:Object(r.jsx)("button",{disabled:0===o.state.APIToken.length||0===o.state.text.length||o.state.current>=o.state.text.split("\n").length,className:"button button--main",onClick:function(){return o.next()},children:"NEXT"})})]})},o.state={APIToken:"",current:0,counter:parseInt(window.location.hash.replace(/[^0-9]/g,""))||0,text:"\u0412 \u044d\u0442\u043e \u0442\u0435\u043a\u0441\u0442\u043e\u0432\u043e\u0435 \u043f\u043e\u043b\u0435 \u043c\u043e\u0436\u043d\u043e \u0432\u0431\u0438\u0442\u044c \u0441\u0432\u043e\u0438 \u0441\u0443\u0431\u0442\u0438\u0442\u0440\u044b.\n\u041a\u0430\u0436\u0434\u0430\u044f \u043d\u043e\u0432\u0430\u044f \u0441\u0442\u0440\u043e\u043a\u0430 \u0431\u0443\u0434\u0435\u0442 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u043c \u0441\u0443\u0431\u0442\u0438\u0442\u0440\u043e\u043c\n\u0427\u0442\u043e\u0431\u044b \u0432 ZOOM \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u043b\u0430\u0441\u044c \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0430\u044f \u0441\u0442\u0440\u043e\u043a\u0430, \u043d\u0430\u0436\u043c\u0438\u0442\u0435 NEXT\n\u042d\u0442\u0443 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u043d\u0435 \u0441\u0442\u043e\u0438\u0442 \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0442\u044c, \u0438\u043d\u0430\u0447\u0435 \u0432\u0441\u0451 \u043c\u043e\u0436\u0435\u0442 \u0441\u0431\u0438\u0442\u044c\u0441\u044f \u0438 \u0441\u043b\u043e\u043c\u0430\u0442\u044c\u0441\u044f\n"},o}return n}(o.Component),P=function(t){Object(u.a)(n,t);var e=Object(l.a)(n);function n(t){var o;Object(i.a)(this,n),(o=e.call(this,t)).setVersion=function(t){o.setState({currentVersion:t}),window.localStorage.setItem("currentVersion",t)},o.renderButtons=function(t){return Object(r.jsxs)("div",{className:t,children:[Object(r.jsxs)("button",{className:"button ".concat("new"===o.state.currentVersion&&"button--selected"),onClick:function(){return o.setVersion("new")},children:["\u043d\u043e\u0432\u0430\u044f \u043a\u0440\u0443\u0442\u0430\u044f \u0432\u0435\u0440\u0441\u0438\u044f ",Object(r.jsx)("span",{className:"emoji",role:"img","aria-label":"new",title:"new",children:"\u2728"})]}),Object(r.jsxs)("button",{className:"button ".concat("old"===o.state.currentVersion&&"button--selected"),onClick:function(){return o.setVersion("old")},children:["\u0441\u0442\u0430\u0440\u0430\u044f \u043f\u0440\u0438\u0432\u044b\u0447\u043d\u0430\u044f \u0432\u0435\u0440\u0441\u0438\u044f ",Object(r.jsx)("span",{className:"emoji",role:"img","aria-label":"old",title:"old",children:"\ud83d\udc74\ud83c\udffb"})]})]})},o.renderHeader=function(){return""},o.renderSelect=function(){return o.renderButtons("App__select")},o.render=function(){var t;switch(o.state.currentVersion){case"old":t=Object(r.jsx)(T,{});break;case"new":t=Object(r.jsx)(N,{});break;default:t=o.renderSelect()}return Object(r.jsxs)("div",{className:"App",children:[o.state.currentVersion&&o.state.currentVersion.match(/new|old/)&&o.renderHeader(),t]})};return o.state={currentVersion:"new"},o}return n}(o.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(Object(r.jsx)(s.a.StrictMode,{children:Object(r.jsx)(P,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[49,1,2]]]);
//# sourceMappingURL=main.029a0643.chunk.js.map