(this["webpackJsonpzoom-cc"]=this["webpackJsonpzoom-cc"]||[]).push([[0],{21:function(e,t,n){},22:function(e,t,n){e.exports=n(47)},47:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(10),s=n.n(o),c=n(4),u=n(5),l=n(6),i=n(11),p=n(8),m=n(1),d=n.n(m),b=n(3),f=n(7),v=n.n(f),h=n(49),g=n(9),k=n.n(g),_={id:{type:"ref"},APIToken:{type:"string",required:!0,example:"zjhdfboepsDKFB"},line:{type:"string",required:!0,example:"\u043f\u0440\u0438\u0432\u0435\u0442,"},number:{type:"number",required:!0,example:0},posted:{type:"number",example:123e4}},w=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).focus=function(){return r.inputFieldRef.current&&r.inputFieldRef.current.focus()},r.blur=function(){return r.inputFieldRef.current&&r.inputFieldRef.current.blur()},r.onKeyDown=function(e){var t=""+r.props.value;r.props.number&&r.props.value&&t.match(/[^0-9]/g)&&r.props.onChange(t.replace(/[^0-9]/g,"")),r.props.onKeyDown&&r.props.onKeyDown(e)},r.onFocus=function(e){r.props.onFocus&&r.props.onFocus(e)},r.onBlur=function(e){r.props.onBlur&&r.props.onBlur(e)},r.render=function(){return a.a.createElement("div",{className:"form-group "+r.props.className+" "+(r.props.errorMessage&&"form-group--error")},a.a.createElement("input",{ref:r.inputFieldRef,type:r.props.number?"number":"text",className:"form-group__input",placeholder:r.props.placeholder,required:r.props.required,value:r.props.value,onChange:function(e){return r.props.onChange(e.target.value)},onFocus:r.onFocus,onBlur:r.onBlur,onKeyDown:r.onKeyDown,disabled:r.props.disabled}),r.props.label&&a.a.createElement("label",{className:"form-group__label"},r.props.label))},r.inputFieldRef=e.inputFieldRef||a.a.createRef(),r}return n}(r.Component),E="https://schedule.tochkadostupa.spb.ru/zoom-cc/";n(21);v.a.defaults.headers.post.Accept="*/*",v.a.defaults.headers.post["Content-Type"]="json";var x=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;Object(c.a)(this,n),(r=t.call(this,e)).componentDidMount=function(){return r.login(r.state.APIToken)},r.activateLoader=function(){var e=Object(b.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.setState({loading:!0}),e.next=3,t();case 3:r.state.subtitles.forEach((function(e){return e.ref.current&&(e.ref.current.style="")})),r.setState({loading:!1});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.tryPost=function(){var e=Object(b.a)(d.a.mark((function e(t,n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.activateLoader(Object(b.a)(d.a.mark((function e(){var o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.post(t,n);case 2:if(!(o=e.sent.data).error){e.next=7;break}return console.log(o.error),alert("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430. \u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043a\u043e\u043d\u0441\u043e\u043b\u044c"),e.abrupt("return");case 7:r.setState({subtitles:[].concat(Object(p.a)(o),[{APIToken:r.state.APIToken,number:0===o.length?1:o[o.length-1].number+1,line:""}]).map((function(e){return Object(i.a)({},e,{ref:a.a.createRef()})}))});case 8:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),r.login=function(){var e=Object(b.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return e.next=3,r.tryPost(E+"login",{APIToken:t});case 3:r.setState({APIToken:t}),window.localStorage.setItem("APIToken",t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.logout=function(){window.localStorage.removeItem("APIToken"),r.setState({APIToken:void 0,subtitles:[],APITokenInput:"",initialText:""})},r.next=Object(b.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.tryPost(E+"next",{APIToken:r.state.APIToken});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),r.saveSubtitle=function(){var e=Object(b.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.tryPost(E+"save",{subtitle:k.a.pick(t,k.a.keys(_))});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.deleteSubtitle=function(){var e=Object(b.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.tryPost(E+"delete",{subtitle:k.a.pick(t,k.a.keys(_))});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.swapSubtitles=function(){var e=Object(b.a)(d.a.mark((function e(t,n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.tryPost(E+"swap",{subtitle0:t.id,subtitle1:n.id});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),r.insertSubtitle=function(e,t){r.setState({subtitles:[].concat(Object(p.a)(r.state.subtitles.slice(0,t+1)),[{line:"",number:e.number+1,APIToken:r.state.APIToken,ref:a.a.createRef()}],Object(p.a)(r.state.subtitles.slice(t+1)))}),setTimeout((function(){return r.state.subtitles[t+1].ref.current.focus()}),200)},r.renderLoading=function(){return r.state.loading&&a.a.createElement("div",{className:"loader"})},r.renderLogin=function(){return a.a.createElement("div",{className:"login"},a.a.createElement("div",{className:"container"},a.a.createElement(w,{value:r.state.APITokenInput,onChange:function(e){return r.setState({APITokenInput:e})},label:"ZOOM API token",placeholder:"\u0421\u043a\u043e\u043f\u0438\u0440\u0443\u0439\u0442\u0435 \u0438 \u0432\u0441\u0442\u0430\u0432\u044c\u0442\u0435 ZOOM API token \u0438\u0437 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f"}),a.a.createElement("button",{className:"button button--main mt-3",onClick:function(){return r.login(r.state.APITokenInput)}},"\u0432\u043e\u0439\u0442\u0438")))},r.renderControl=function(){return a.a.createElement("div",{className:"control"},a.a.createElement("div",{className:"container"},a.a.createElement("div",{className:"control__header"},a.a.createElement("div",{className:"control__header__token"},r.state.APIToken.slice(r.state.APIToken.indexOf("id"))),a.a.createElement("button",{className:"control__header__exit",onClick:function(){return r.logout()}},"\u0432\u044b\u0439\u0442\u0438"))),a.a.createElement("div",{className:"control__content"},r.renderSubtitles()),a.a.createElement("div",{className:"control__next"},a.a.createElement("div",{className:"container"},a.a.createElement("button",{disabled:0===r.state.subtitles.filter((function(e){return!e.posted})).length||!r.state.subtitles.filter((function(e){return!e.posted}))[0].id,className:"button button--main",onClick:function(){return r.next()}},"NEXT"))))},r.renderSubtitles=function(){return a.a.createElement("div",{className:"container"},a.a.createElement("div",{className:"control__subtitles"},0!==r.state.subtitles.length&&r.state.subtitles[0].id?r.state.subtitles.map((function(e,t){return a.a.createElement("div",{key:e.id||e.number,className:"control__subtitles__item ".concat(e.posted&&"control__subtitles__item--posted")},a.a.createElement("div",{className:"control__subtitles__item__number"},e.id&&"".concat(e.number,".")),e.posted?a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"control__subtitles__item__input"},e.line),a.a.createElement("div",{className:"control__subtitles__item__posted"},Object(h.a)(new Date(e.posted),"HH:mm:ss"))):a.a.createElement(a.a.Fragment,null,a.a.createElement("textarea",{ref:e.ref,className:"control__subtitles__item__input",value:e.line,rows:1,onKeyDown:function(t){return 27===t.keyCode&&e.ref.current&&e.ref.current.blur()},onChange:function(n){r.setState({subtitles:[].concat(Object(p.a)(r.state.subtitles.slice(0,t)),[Object(i.a)({},e,{line:n.target.value})],Object(p.a)(r.state.subtitles.slice(t+1)))}),n.target.value.includes("\n")&&(e.ref.current.style.height="200px")},onBlur:function(){return r.saveSubtitle(e)}}),a.a.createElement("div",{className:"control__subtitles__item__buttons"},a.a.createElement("button",{className:"button button--transparent",disabled:!e.id||t>r.state.subtitles.length-3,onClick:function(){return r.insertSubtitle(e,t)}},"+"),a.a.createElement("button",{className:"button button--transparent",disabled:!e.id,onClick:function(){return r.deleteSubtitle(e)}},"-"),a.a.createElement("button",{className:"button button--transparent",disabled:!e.id||t===r.state.subtitles.length-2,onClick:function(){return r.swapSubtitles(e,r.state.subtitles[t+1])}},"\u21e9"),a.a.createElement("button",{className:"button button--transparent",disabled:!e.id||0===t||0!==r.state.subtitles[t-1].posted,onClick:function(){return r.swapSubtitles(e,r.state.subtitles[t-1])}},"\u2191"))))})):a.a.createElement(a.a.Fragment,null,a.a.createElement("textarea",{className:"control__subtitles__textarea",value:r.state.initialText,onChange:function(e){return r.setState({initialText:e.target.value})},placeholder:"\u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442 \u0438 \u043d\u0430\u0436\u043c\u0438\u0442\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"}),a.a.createElement("button",{className:"button button--main",disabled:0===r.state.initialText.length,onClick:function(){return r.saveSubtitle({line:r.state.initialText,APIToken:r.state.APIToken,number:1})}},"\u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))))},r.render=function(){return a.a.createElement("div",{className:"NewVersion"},r.state.APIToken?r.renderControl():r.renderLogin(),s.a.createPortal(r.renderLoading(),document.body))};var o=window.localStorage.getItem("APIToken");return r.state={APIToken:o||"",APITokenInput:"",subtitles:[],initialText:"",loading:!1},r}return n}(a.a.Component);v.a.defaults.headers.post.Accept="*/*",v.a.defaults.headers.post["Content-Type"]="json";var N=function(e){return e.APIToken+"&seq=".concat(e.count,"&lang=ru")},I=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,e)).next=function(){var e=r.state,t=e.current,n=e.counter,a=e.text,o=e.APIToken;t>=a.split("\n").length||(window.history.replaceState(null,null,"/zoom-cc/#"+n),console.log(n),function(e){v.a.post(E+"old",{URL:N(e),string:e.string+"\n"}).then((function(e){return console.log(e.data)}))}({string:a.split("\n")[t],count:n,APIToken:o}),r.setState({current:t+1,counter:n+1}))},r.render=function(){return a.a.createElement("div",{className:"OldVersion"},a.a.createElement("div",{className:"container"},a.a.createElement(w,{value:r.state.APIToken,onChange:function(e){return r.setState({APIToken:e})},label:"ZOOM API token",placeholder:"\u0421\u043a\u043e\u043f\u0438\u0440\u0443\u0439\u0442\u0435 \u0438 \u0432\u0441\u0442\u0430\u0432\u044c\u0442\u0435 ZOOM API token \u0438\u0437 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f"})),a.a.createElement("div",{className:"container"},"\u0422\u0435\u043a\u0443\u0449\u0438\u0439 \u0441\u0443\u0431\u0442\u0438\u0442\u0440: ",0===r.state.current?"":r.state.current<=r.state.text.split("\n").length&&r.state.text.split("\n")[r.state.current-1]),a.a.createElement("div",{className:"container"},a.a.createElement("textarea",{className:"LinedTextArea",value:r.state.text,onChange:function(e){return r.setState({text:e.target.value})}})),a.a.createElement("div",{className:"container"},a.a.createElement("button",{disabled:0===r.state.APIToken.length||0===r.state.text.length||r.state.current>=r.state.text.split("\n").length,className:"button button--main",onClick:function(){return r.next()}},"NEXT")))},r.state={APIToken:"",current:0,counter:parseInt(window.location.hash.replace(/[^0-9]/g,""))||0,text:"\u0412 \u044d\u0442\u043e \u0442\u0435\u043a\u0441\u0442\u043e\u0432\u043e\u0435 \u043f\u043e\u043b\u0435 \u043c\u043e\u0436\u043d\u043e \u0432\u0431\u0438\u0442\u044c \u0441\u0432\u043e\u0438 \u0441\u0443\u0431\u0442\u0438\u0442\u0440\u044b.\n\u041a\u0430\u0436\u0434\u0430\u044f \u043d\u043e\u0432\u0430\u044f \u0441\u0442\u0440\u043e\u043a\u0430 \u0431\u0443\u0434\u0435\u0442 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u043c \u0441\u0443\u0431\u0442\u0438\u0442\u0440\u043e\u043c\n\u0427\u0442\u043e\u0431\u044b \u0432 ZOOM \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u043b\u0430\u0441\u044c \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0430\u044f \u0441\u0442\u0440\u043e\u043a\u0430, \u043d\u0430\u0436\u043c\u0438\u0442\u0435 NEXT\n\u042d\u0442\u0443 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u043d\u0435 \u0441\u0442\u043e\u0438\u0442 \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0442\u044c, \u0438\u043d\u0430\u0447\u0435 \u0432\u0441\u0451 \u043c\u043e\u0436\u0435\u0442 \u0441\u0431\u0438\u0442\u044c\u0441\u044f \u0438 \u0441\u043b\u043e\u043c\u0430\u0442\u044c\u0441\u044f\n"},r}return n}(r.Component),T=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;Object(c.a)(this,n),(r=t.call(this,e)).setVersion=function(e){r.setState({currentVersion:e}),window.localStorage.setItem("currentVersion",e)},r.renderButtons=function(e){return a.a.createElement("div",{className:e},a.a.createElement("button",{className:"button ".concat("new"===r.state.currentVersion&&"button--selected"),onClick:function(){return r.setVersion("new")}},"\u043d\u043e\u0432\u0430\u044f \u043a\u0440\u0443\u0442\u0430\u044f \u0432\u0435\u0440\u0441\u0438\u044f ",a.a.createElement("span",{className:"emoji",role:"img","aria-label":"new",title:"new"},"\u2728")),a.a.createElement("button",{className:"button ".concat("old"===r.state.currentVersion&&"button--selected"),onClick:function(){return r.setVersion("old")}},"\u0441\u0442\u0430\u0440\u0430\u044f \u043f\u0440\u0438\u0432\u044b\u0447\u043d\u0430\u044f \u0432\u0435\u0440\u0441\u0438\u044f ",a.a.createElement("span",{className:"emoji",role:"img","aria-label":"old",title:"old"},"\ud83d\udc74\ud83c\udffb")))},r.renderHeader=function(){return r.renderButtons("App__header")},r.renderSelect=function(){return r.renderButtons("App__select")},r.render=function(){var e;switch(r.state.currentVersion){case"old":e=a.a.createElement(I,null);break;case"new":e=a.a.createElement(x,null);break;default:e=r.renderSelect()}return a.a.createElement("div",{className:"App"},r.state.currentVersion&&r.state.currentVersion.match(/new|old/)&&r.renderHeader(),e)};var o=window.localStorage.getItem("currentVersion");return r.state={currentVersion:o},r}return n}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(T,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[22,1,2]]]);
//# sourceMappingURL=main.173dade2.chunk.js.map