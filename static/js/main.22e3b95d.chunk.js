(this["webpackJsonpzoom-cc"]=this["webpackJsonpzoom-cc"]||[]).push([[0],{22:function(e,t,n){},48:function(e,t,n){"use strict";n.r(t);var r=n(0),s=n(2),a=n.n(s),o=n(12),c=n.n(o),i=n(5),u=n(7),l=n(6),d=n(11),b=n(9),p=n(1),j=n.n(p),f=n(4),h=n(8),m=n.n(h),x=n(50),O=n(10),v=n.n(O),g={id:{type:"ref"},APIToken:{type:"string",required:!0,example:"zjhdfboepsDKFB"},line:{type:"string",required:!0,example:"\u043f\u0440\u0438\u0432\u0435\u0442,"},number:{type:"number",required:!0,example:0},posted:{type:"number",example:123e4}},k=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var s;return Object(i.a)(this,n),(s=t.call(this,e)).focus=function(){return s.inputFieldRef.current&&s.inputFieldRef.current.focus()},s.blur=function(){return s.inputFieldRef.current&&s.inputFieldRef.current.blur()},s.onKeyDown=function(e){var t=""+s.props.value;s.props.number&&s.props.value&&t.match(/[^0-9]/g)&&s.props.onChange(t.replace(/[^0-9]/g,"")),s.props.onKeyDown&&s.props.onKeyDown(e)},s.onFocus=function(e){s.props.onFocus&&s.props.onFocus(e)},s.onBlur=function(e){s.props.onBlur&&s.props.onBlur(e)},s.render=function(){return Object(r.jsxs)("div",{className:"form-group "+s.props.className+" "+(s.props.errorMessage&&"form-group--error"),children:[Object(r.jsx)("input",{ref:s.inputFieldRef,type:s.props.number?"number":"text",className:"form-group__input",placeholder:s.props.placeholder,required:s.props.required,value:s.props.value,onChange:function(e){return s.props.onChange(e.target.value)},onFocus:s.onFocus,onBlur:s.onBlur,onKeyDown:s.onKeyDown,disabled:s.props.disabled}),s.props.label&&Object(r.jsx)("label",{className:"form-group__label",children:s.props.label})]})},s.inputFieldRef=e.inputFieldRef||a.a.createRef(),s}return n}(s.Component),_="https://schedule.tochkadostupa.spb.ru/zoom-cc/";n(22);m.a.defaults.headers.post.Accept="*/*",m.a.defaults.headers.post["Content-Type"]="json";var w=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var s;Object(i.a)(this,n),(s=t.call(this,e)).componentDidMount=function(){return s.login(s.state.APIToken)},s.activateLoader=function(){var e=Object(f.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.setState({loading:!0}),e.next=3,t();case 3:s.state.subtitles.forEach((function(e){return e.ref.current&&(e.ref.current.style="")})),s.setState({loading:!1});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.tryPost=function(){var e=Object(f.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.activateLoader(Object(f.a)(j.a.mark((function e(){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.post(t,n);case 2:if(!(r=e.sent.data).error){e.next=7;break}return console.log(r.error),alert("Error: check the console"),e.abrupt("return");case 7:s.setState({subtitles:[].concat(Object(b.a)(r),[{APIToken:s.state.APIToken,number:0===r.length?1:r[r.length-1].number+1,line:""}]).map((function(e){return Object(d.a)(Object(d.a)({},e),{},{ref:a.a.createRef()})}))});case 8:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),s.login=function(){var e=Object(f.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return e.next=3,s.tryPost(_+"login",{APIToken:t});case 3:s.setState({APIToken:t}),window.localStorage.setItem("APIToken",t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.logout=function(){window.localStorage.removeItem("APIToken"),s.setState({APIToken:void 0,subtitles:[],APITokenInput:"",initialText:""})},s.next=Object(f.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.tryPost(_+"next",{APIToken:s.state.APIToken});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),s.saveSubtitle=function(){var e=Object(f.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.tryPost(_+"save",{subtitle:v.a.pick(t,v.a.keys(g))});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.deleteSubtitle=function(){var e=Object(f.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.tryPost(_+"delete",{subtitle:v.a.pick(t,v.a.keys(g))});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.swapSubtitles=function(){var e=Object(f.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.tryPost(_+"swap",{subtitle0:t.id,subtitle1:n.id});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),s.insertSubtitle=function(e,t){s.setState({subtitles:[].concat(Object(b.a)(s.state.subtitles.slice(0,t+1)),[{line:"",number:e.number+1,APIToken:s.state.APIToken,ref:a.a.createRef()}],Object(b.a)(s.state.subtitles.slice(t+1)))}),setTimeout((function(){return s.state.subtitles[t+1].ref.current.focus()}),200)},s.renderLoading=function(){return s.state.loading&&Object(r.jsx)("div",{className:"loader"})},s.renderLogin=function(){return Object(r.jsx)("div",{className:"login",children:Object(r.jsxs)("div",{className:"container",children:[Object(r.jsx)(k,{value:s.state.APITokenInput,onChange:function(e){return s.setState({APITokenInput:e})},label:"ZOOM API token",placeholder:"Copy the API token from Zoom. Paste it here"}),Object(r.jsx)("button",{className:"button button--main mt-3",onClick:function(){return s.login(s.state.APITokenInput)},children:"Log in"})]})})},s.renderControl=function(){return Object(r.jsxs)("div",{className:"control",children:[Object(r.jsx)("div",{className:"container",children:Object(r.jsxs)("div",{className:"control__header",children:[Object(r.jsx)("div",{className:"control__header__token",children:s.state.APIToken.slice(s.state.APIToken.indexOf("id"))}),Object(r.jsx)("button",{className:"control__header__exit",onClick:function(){return s.logout()},children:"Log out"})]})}),Object(r.jsx)("div",{className:"control__content",children:s.renderSubtitles()}),Object(r.jsx)("div",{className:"control__next",children:Object(r.jsx)("div",{className:"container",children:Object(r.jsx)("button",{disabled:0===s.state.subtitles.filter((function(e){return!e.posted})).length||!s.state.subtitles.filter((function(e){return!e.posted}))[0].id,className:"button button--main",onClick:function(){return s.next()},children:"NEXT"})})})]})},s.renderSubtitles=function(){return Object(r.jsx)("div",{className:"container",children:Object(r.jsx)("div",{className:"control__subtitles",children:0!==s.state.subtitles.length&&s.state.subtitles[0].id?s.state.subtitles.map((function(e,t){return Object(r.jsxs)("div",{className:"control__subtitles__item ".concat(e.posted&&"control__subtitles__item--posted"),children:[Object(r.jsx)("div",{className:"control__subtitles__item__number",children:e.id&&"".concat(e.number,".")}),e.posted?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("div",{className:"control__subtitles__item__input",children:e.line}),Object(r.jsx)("div",{className:"control__subtitles__item__posted",children:Object(x.a)(new Date(e.posted),"HH:mm:ss")})]}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("textarea",{ref:e.ref,className:"control__subtitles__item__input",value:e.line,rows:1,onKeyDown:function(t){return 27===t.keyCode&&e.ref.current&&e.ref.current.blur()},onChange:function(n){s.setState({subtitles:[].concat(Object(b.a)(s.state.subtitles.slice(0,t)),[Object(d.a)(Object(d.a)({},e),{},{line:n.target.value})],Object(b.a)(s.state.subtitles.slice(t+1)))}),n.target.value.includes("\n")&&(e.ref.current.style.height="200px")},onBlur:function(){return s.saveSubtitle(e)}}),Object(r.jsxs)("div",{className:"control__subtitles__item__buttons",children:[Object(r.jsx)("button",{className:"button button--transparent",disabled:!e.id||t>s.state.subtitles.length-3,onClick:function(){return s.insertSubtitle(e,t)},children:"+"}),Object(r.jsx)("button",{className:"button button--transparent",disabled:!e.id,onClick:function(){return s.deleteSubtitle(e)},children:"-"}),Object(r.jsx)("button",{className:"button button--transparent",disabled:!e.id||t===s.state.subtitles.length-2,onClick:function(){return s.swapSubtitles(e,s.state.subtitles[t+1])},children:"\u21e9"}),Object(r.jsx)("button",{className:"button button--transparent",disabled:!e.id||0===t||0!==s.state.subtitles[t-1].posted,onClick:function(){return s.swapSubtitles(e,s.state.subtitles[t-1])},children:"\u2191"})]})]})]},e.id||e.number)})):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("textarea",{className:"control__subtitles__textarea",value:s.state.initialText,onChange:function(e){return s.setState({initialText:e.target.value})},placeholder:"\u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442 \u0438 \u043d\u0430\u0436\u043c\u0438\u0442\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"}),Object(r.jsx)("button",{className:"button button--main",disabled:0===s.state.initialText.length,onClick:function(){return s.saveSubtitle({line:s.state.initialText,APIToken:s.state.APIToken,number:1})},children:"save"})]})})})},s.render=function(){return Object(r.jsxs)("div",{className:"NewVersion",children:[s.state.APIToken?s.renderControl():s.renderLogin(),c.a.createPortal(s.renderLoading(),document.body)]})};var o=window.localStorage.getItem("APIToken");return s.state={APIToken:o||"",APITokenInput:"",subtitles:[],initialText:"",loading:!1},s}return n}(a.a.Component);m.a.defaults.headers.post.Accept="*/*",m.a.defaults.headers.post["Content-Type"]="json";var N=function(e){return e.APIToken+"&seq=".concat(e.count,"&lang=ru")},I=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var s;return Object(i.a)(this,n),(s=t.call(this,e)).next=function(){var e=s.state,t=e.current,n=e.counter,r=e.text,a=e.APIToken;t>=r.split("\n").length||(window.history.replaceState(null,null,"/zoom-cc/#"+n),console.log(n),function(e){m.a.post(_+"old",{URL:N(e),string:e.string+"\n"}).then((function(e){return console.log(e.data)}))}({string:r.split("\n")[t],count:n,APIToken:a}),s.setState({current:t+1,counter:n+1}))},s.render=function(){return Object(r.jsxs)("div",{className:"OldVersion",children:[Object(r.jsx)("div",{className:"container",children:Object(r.jsx)(k,{value:s.state.APIToken,onChange:function(e){return s.setState({APIToken:e})},label:"ZOOM API token",placeholder:"\u0421\u043a\u043e\u043f\u0438\u0440\u0443\u0439\u0442\u0435 \u0438 \u0432\u0441\u0442\u0430\u0432\u044c\u0442\u0435 ZOOM API token \u0438\u0437 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f"})}),Object(r.jsxs)("div",{className:"container",children:["\u0422\u0435\u043a\u0443\u0449\u0438\u0439 \u0441\u0443\u0431\u0442\u0438\u0442\u0440: ",0===s.state.current?"":s.state.current<=s.state.text.split("\n").length&&s.state.text.split("\n")[s.state.current-1]]}),Object(r.jsx)("div",{className:"container",children:Object(r.jsx)("textarea",{className:"LinedTextArea",value:s.state.text,onChange:function(e){return s.setState({text:e.target.value})}})}),Object(r.jsx)("div",{className:"container",children:Object(r.jsx)("button",{disabled:0===s.state.APIToken.length||0===s.state.text.length||s.state.current>=s.state.text.split("\n").length,className:"button button--main",onClick:function(){return s.next()},children:"NEXT"})})]})},s.state={APIToken:"",current:0,counter:parseInt(window.location.hash.replace(/[^0-9]/g,""))||0,text:"\u0412 \u044d\u0442\u043e \u0442\u0435\u043a\u0441\u0442\u043e\u0432\u043e\u0435 \u043f\u043e\u043b\u0435 \u043c\u043e\u0436\u043d\u043e \u0432\u0431\u0438\u0442\u044c \u0441\u0432\u043e\u0438 \u0441\u0443\u0431\u0442\u0438\u0442\u0440\u044b.\n\u041a\u0430\u0436\u0434\u0430\u044f \u043d\u043e\u0432\u0430\u044f \u0441\u0442\u0440\u043e\u043a\u0430 \u0431\u0443\u0434\u0435\u0442 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u043c \u0441\u0443\u0431\u0442\u0438\u0442\u0440\u043e\u043c\n\u0427\u0442\u043e\u0431\u044b \u0432 ZOOM \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u043b\u0430\u0441\u044c \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0430\u044f \u0441\u0442\u0440\u043e\u043a\u0430, \u043d\u0430\u0436\u043c\u0438\u0442\u0435 NEXT\n\u042d\u0442\u0443 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u043d\u0435 \u0441\u0442\u043e\u0438\u0442 \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0442\u044c, \u0438\u043d\u0430\u0447\u0435 \u0432\u0441\u0451 \u043c\u043e\u0436\u0435\u0442 \u0441\u0431\u0438\u0442\u044c\u0441\u044f \u0438 \u0441\u043b\u043e\u043c\u0430\u0442\u044c\u0441\u044f\n"},s}return n}(s.Component),T=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var s;Object(i.a)(this,n),(s=t.call(this,e)).setVersion=function(e){s.setState({currentVersion:e}),window.localStorage.setItem("currentVersion",e)},s.renderButtons=function(e){return Object(r.jsxs)("div",{className:e,children:[Object(r.jsxs)("button",{className:"button ".concat("new"===s.state.currentVersion&&"button--selected"),onClick:function(){return s.setVersion("new")},children:["\u043d\u043e\u0432\u0430\u044f \u043a\u0440\u0443\u0442\u0430\u044f \u0432\u0435\u0440\u0441\u0438\u044f ",Object(r.jsx)("span",{className:"emoji",role:"img","aria-label":"new",title:"new",children:"\u2728"})]}),Object(r.jsxs)("button",{className:"button ".concat("old"===s.state.currentVersion&&"button--selected"),onClick:function(){return s.setVersion("old")},children:["\u0441\u0442\u0430\u0440\u0430\u044f \u043f\u0440\u0438\u0432\u044b\u0447\u043d\u0430\u044f \u0432\u0435\u0440\u0441\u0438\u044f ",Object(r.jsx)("span",{className:"emoji",role:"img","aria-label":"old",title:"old",children:"\ud83d\udc74\ud83c\udffb"})]})]})},s.renderHeader=function(){return""},s.renderSelect=function(){return s.renderButtons("App__select")},s.render=function(){var e;switch(s.state.currentVersion){case"old":e=Object(r.jsx)(I,{});break;case"new":e=Object(r.jsx)(w,{});break;default:e=s.renderSelect()}return Object(r.jsxs)("div",{className:"App",children:[s.state.currentVersion&&s.state.currentVersion.match(/new|old/)&&s.renderHeader(),e]})};return s.state={currentVersion:"new"},s}return n}(s.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(Object(r.jsx)(a.a.StrictMode,{children:Object(r.jsx)(T,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[48,1,2]]]);
//# sourceMappingURL=main.22e3b95d.chunk.js.map