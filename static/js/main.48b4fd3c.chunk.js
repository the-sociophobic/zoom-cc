(this["webpackJsonpzoom-cc"]=this["webpackJsonpzoom-cc"]||[]).push([[0],{21:function(e,t,n){e.exports=n(47)},46:function(e,t,n){},47:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(6),s=n.n(o),u=n(11),c=n(4),i=n(1),l=n.n(i),p=n(3),b=n(7),m=n(8),d=n(9),f=n(10),v=n.n(f),_=n(49),h=n(5),k=n.n(h),g={id:{type:"ref"},APIToken:{type:"string",required:!0,example:"zjhdfboepsDKFB"},line:{type:"string",required:!0,example:"\u043f\u0440\u0438\u0432\u0435\u0442,"},number:{type:"number",required:!0,example:0},posted:{type:"number",example:123e4}},w=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(b.a)(this,n),(r=t.call(this,e)).focus=function(){return r.inputFieldRef.current&&r.inputFieldRef.current.focus()},r.blur=function(){return r.inputFieldRef.current&&r.inputFieldRef.current.blur()},r.onKeyDown=function(e){var t=""+r.props.value;r.props.number&&r.props.value&&t.match(/[^0-9]/g)&&r.props.onChange(t.replace(/[^0-9]/g,"")),r.props.onKeyDown&&r.props.onKeyDown(e)},r.onFocus=function(e){r.props.onFocus&&r.props.onFocus(e)},r.onBlur=function(e){r.props.onBlur&&r.props.onBlur(e)},r.render=function(){return a.a.createElement("div",{className:"form-group "+r.props.className+" "+(r.props.errorMessage&&"form-group--error")},a.a.createElement("input",{ref:r.inputFieldRef,type:r.props.number?"number":"text",className:"form-group__input",placeholder:r.props.placeholder,required:r.props.required,value:r.props.value,onChange:function(e){return r.props.onChange(e.target.value)},onFocus:r.onFocus,onBlur:r.onBlur,onKeyDown:r.onKeyDown,disabled:r.props.disabled}),r.props.label&&a.a.createElement("label",{className:"form-group__label"},r.props.label))},r.inputFieldRef=e.inputFieldRef||a.a.createRef(),r}return n}(r.Component);n(46);v.a.defaults.headers.post.Accept="*/*",v.a.defaults.headers.post["Content-Type"]="json";var x="https://schedule.tochkadostupa.spb.ru/zoom-cc/",E=("\n  \u042f \u0432 \u0440\u043e\u0442 \u0435\u0431\u0430\u043b \u0442\u0432\u043e\u044e \u043c\u0430\u0442\u044c,\n  \u041f\u043e\u0439\u0434\u0443 \u043d\u0430\u0441\u0440\u0443 \u0435\u0439 \u043d\u0430 \u0433\u0440\u0443\u0434\u044c.\n  \u042f \u043d\u0435 \u0445\u043e\u0447\u0443 \u0435\u0451 \u0435\u0431\u0430\u0442\u044c,\n  \u041b\u0443\u0447\u0448\u0435 \u043c\u043e\u0447\u0438 \u043f\u043e\u0439\u0442\u0438 \u0445\u043b\u0435\u0431\u043d\u0443\u0442\u044c.\n  \u0413\u043e\u0432\u043d\u043e \u0432\u043a\u0443\u0441\u043d\u0435\u0439 \u0435\u0451 \u0441\u0442\u0440\u044f\u043f\u043d\u0438.\n  \u0410 \u043f\u0443\u043a \u043b\u0443\u0447\u0448\u0435 \u0437\u0432\u0443\u0447\u0438\u0442,\n  \u0427\u0435\u043c \u0433\u043e\u043b\u043e\u0441 \u044d\u0442\u043e\u0439 \u0445\u0443\u0435\u0440\u0433\u0438.\n  \u041f\u043e\u0439\u0434\u0438 \u0438 \u0451\u0431\u043d\u0438 \u0435\u0439 \u0441 \u043d\u043e\u0433\u0438.\n".split("\n").map((function(e){return{line:e,ref:a.a.createRef()}})),function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e){var r;Object(b.a)(this,n),(r=t.call(this,e)).componentDidMount=function(){return r.login(r.state.APIToken)},r.activateLoader=function(){var e=Object(p.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.setState({loading:!0}),e.next=3,t();case 3:r.state.subtitles.forEach((function(e){return e.ref.current&&(e.ref.current.style="")})),r.setState({loading:!1});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.tryPost=function(){var e=Object(p.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.activateLoader(Object(p.a)(l.a.mark((function e(){var o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.post(t,n);case 2:if(!(o=e.sent.data).error){e.next=7;break}return console.log(o.error),alert("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430. \u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043a\u043e\u043d\u0441\u043e\u043b\u044c"),e.abrupt("return");case 7:r.setState({subtitles:[].concat(Object(c.a)(o),[{APIToken:r.state.APIToken,number:0===o.length?1:o[o.length-1].number+1,line:""}]).map((function(e){return Object(u.a)({},e,{ref:a.a.createRef()})}))});case 8:case"end":return e.stop()}}),e)}))));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),r.login=function(){var e=Object(p.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return e.next=3,r.tryPost(x+"login",{APIToken:t});case 3:r.setState({APIToken:t}),window.localStorage.setItem("APIToken",t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.logout=function(){window.localStorage.removeItem("APIToken"),r.setState({APIToken:void 0,subtitles:[],APITokenInput:"",initialText:""})},r.next=Object(p.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.tryPost(x+"next",{APIToken:r.state.APIToken});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),r.saveSubtitle=function(){var e=Object(p.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.tryPost(x+"save",{subtitle:k.a.pick(t,k.a.keys(g))});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.deleteSubtitle=function(){var e=Object(p.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.tryPost(x+"delete",{subtitle:k.a.pick(t,k.a.keys(g))});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.swapSubtitles=function(){var e=Object(p.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.tryPost(x+"swap",{subtitle0:t.id,subtitle1:n.id});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),r.insertSubtitle=function(e,t){r.setState({subtitles:[].concat(Object(c.a)(r.state.subtitles.slice(0,t+1)),[{line:"",number:e.number+1,APIToken:r.state.APIToken,ref:a.a.createRef()}],Object(c.a)(r.state.subtitles.slice(t+1)))}),setTimeout((function(){return r.state.subtitles[t+1].ref.current.focus()}),200)},r.renderLoading=function(){return r.state.loading&&a.a.createElement("div",{className:"loader"})},r.renderLogin=function(){return a.a.createElement("div",{className:"login"},a.a.createElement("div",{className:"container"},a.a.createElement(w,{value:r.state.APITokenInput,onChange:function(e){return r.setState({APITokenInput:e})},label:"ZOOM API token",placeholder:"\u0421\u043a\u043e\u043f\u0438\u0440\u0443\u0439\u0442\u0435 \u0438 \u0432\u0441\u0442\u0430\u0432\u044c\u0442\u0435 ZOOM API token \u0438\u0437 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f"}),a.a.createElement("button",{className:"button button--main mt-3",onClick:function(){return r.login(r.state.APITokenInput)}},"\u0432\u043e\u0439\u0442\u0438")))},r.renderControl=function(){return a.a.createElement("div",{className:"control"},a.a.createElement("div",{className:"container"},a.a.createElement("div",{className:"control__header"},a.a.createElement("div",{className:"control__header__token"},r.state.APIToken.slice(r.state.APIToken.indexOf("id"))),a.a.createElement("button",{className:"control__header__exit",onClick:function(){return r.logout()}},"\u0432\u044b\u0439\u0442\u0438")),r.renderSubtitles(),a.a.createElement("div",{className:"control__next"},a.a.createElement("button",{disabled:0===r.state.subtitles.filter((function(e){return!e.posted})).length||!r.state.subtitles.filter((function(e){return!e.posted}))[0].id,className:"button button--main",onClick:function(){return r.next()}},"NEXT"))))},r.renderSubtitles=function(){return a.a.createElement("div",{className:"control__subtitles"},0!==r.state.subtitles.length&&r.state.subtitles[0].id?r.state.subtitles.map((function(e,t){return a.a.createElement("div",{key:e.id||e.number,className:"control__subtitles__item ".concat(e.posted&&"control__subtitles__item--posted")},a.a.createElement("div",{className:"control__subtitles__item__number"},e.id&&"".concat(e.number,".")),e.posted?a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"control__subtitles__item__input"},e.line),a.a.createElement("div",{className:"control__subtitles__item__posted"},Object(_.a)(new Date(e.posted),"HH:mm:ss"))):a.a.createElement(a.a.Fragment,null,a.a.createElement("textarea",{ref:e.ref,className:"control__subtitles__item__input",value:e.line,rows:1,onKeyDown:function(t){return 27===t.keyCode&&e.ref.current&&e.ref.current.blur()},onChange:function(n){r.setState({subtitles:[].concat(Object(c.a)(r.state.subtitles.slice(0,t)),[Object(u.a)({},e,{line:n.target.value})],Object(c.a)(r.state.subtitles.slice(t+1)))}),n.target.value.includes("\n")&&(e.ref.current.style.height="200px")},onBlur:function(){return r.saveSubtitle(e)}}),a.a.createElement("div",{className:"control__subtitles__item__buttons"},a.a.createElement("button",{className:"button button--transparent",disabled:!e.id||t>r.state.subtitles.length-3,onClick:function(){return r.insertSubtitle(e,t)}},"+"),a.a.createElement("button",{className:"button button--transparent",disabled:!e.id,onClick:function(){return r.deleteSubtitle(e)}},"-"),a.a.createElement("button",{className:"button button--transparent",disabled:!e.id||t===r.state.subtitles.length-2,onClick:function(){return r.swapSubtitles(e,r.state.subtitles[t+1])}},"\u21e9"),a.a.createElement("button",{className:"button button--transparent",disabled:!e.id||0===t||0!==r.state.subtitles[t-1].posted,onClick:function(){return r.swapSubtitles(e,r.state.subtitles[t-1])}},"\u2191"))))})):a.a.createElement(a.a.Fragment,null,a.a.createElement("textarea",{className:"control__subtitles__textarea",value:r.state.initialText,onChange:function(e){return r.setState({initialText:e.target.value})},placeholder:"\u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442 \u0438 \u043d\u0430\u0436\u043c\u0438\u0442\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"}),a.a.createElement("button",{className:"button button--main",disabled:0===r.state.initialText.length,onClick:function(){return r.saveSubtitle({line:r.state.initialText,APIToken:r.state.APIToken,number:1})}},"\u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")))},r.render=function(){return a.a.createElement("div",{className:"App"},r.state.APIToken?r.renderControl():r.renderLogin(),s.a.createPortal(r.renderLoading(),document.body))};var o=window.localStorage.getItem("APIToken");return r.state={APIToken:o||"",APITokenInput:"",subtitles:[],initialText:"",loading:!1},r}return n}(r.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(E,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[21,1,2]]]);
//# sourceMappingURL=main.48b4fd3c.chunk.js.map